<!DOCTYPE html>
<html>
<!-- VUG:https://github.com/hsiangleev/layuiExtend/issues/23-->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Weathon文档管理系统 | 文档查看</title>
  <link rel="stylesheet" href="./src/layui/css/layui.css">
  <link rel="stylesheet" href="eleTree.css" media="all">
  <script type="text/javascript" src="/eel.js"></script>
</head>




<body class="layui-layout-body">
  <div class="layui-layout layui-layout-admin">
    <div class="layui-header">
      <div class="layui-logo">Weathon文档管理系统</div>
      <!-- 头部区域（可配合l ayui已有的水平导航） -->
      <ul class="layui-nav layui-layout-left">
        <li class="layui-nav-item"><a href="./index.html">文档管理</a></li>
        <li class="layui-nav-item"><a href="./setting.html">设置</a></li>
        <li class="layui-nav-item"><a href="./search.html">文档查找</a></li>


        <!-- Menu -->
        <li class="layui-nav-item">
          <a href="javascript:;">导入</a>
          <dl class="layui-nav-child">
            <dd><a href="scan.html">从扫描仪</a></dd>
            <dd><a href="upload.html">从文件</a></dd>
          </dl>
        </li>

        <!-- Menu End -->
        <li class="layui-nav-item">
          <!--
            <a href="javascript:;">其它系统</a>
            <dl class="layui-nav-child">
              <dd><a href="">邮件管理</a></dd>
              <dd><a href="">消息管理</a></dd>
              <dd><a href="">授权管理</a></dd>
            </dl>
-->
        </li>
      </ul>
      <ul class="layui-nav layui-layout-right">
        <li class="layui-nav-item">
          <a href="javascript:;">
            <img src="cat.png" class="layui-nav-img">
            管理员
          </a>
          <dl class="layui-nav-child">
            <dd><a href="./setting.html">设置</a></dd>
            <dd><a href="./logout.html">退出系统</a></dd>
          </dl>
        </li>


    </div>
    <div class="layui-side layui-bg-black">
      <div class="eleTree ele1" lay-filter="data1"></div>
      <br /><br />
      <div>点击<div class="layui-btn layui-btn-xs" onclick="tree_commit();">此处</div>提交更改</div>
    </div>

    <div class="layui-body">
      <!-- 内容主体区域 -->
      <iframe src="./table.html" height=90% width="100%"></iframe>
    </div>


    <script src='./src/layui/layui.js'></script>
    <script>
      async function tree_commit() {
        var ret = await eel.setTree(JSON.stringify(tree1.datas().data))();
        if (ret == 0) {
          alert("修改成功！")
        }
        else {
          alert("修改失败！请刷新后重试或记录下以下信息联系支持部门。\n" + ret)
        }
      }

    </script>
    <script>



      layui.config({
        base: "./src/layui/lay/mymodules/"
      }).use(['jquery', 'table', 'eleTree', 'code', 'element'], async function () {
        var $ = layui.jquery;
        var eleTree = layui.eleTree;
        var table = layui.table;
        var code = layui.code;
        var returns = await eel.getD()();
        var data = JSON.parse(returns);

        var ele1 = eleTree.render({
          elem: '.ele1',
          data: data,
          // checkOnClickNode:true,
          contextmenuList: ["copy", "add", "edit", "remove"],
          draggable: true
          // expandOnClickNode: false,
        });
        tree1=ele1;
        eleTree.on("nodeClick(data1)", function (d) {
          console.log(d.data);    // 点击节点对于的数据
          console.log(d.event);   // event对象
          console.log(d.node);    // 点击的dom节点
          console.log(this);      // 与d.node相同
        })
      });
      // yan jing na shou 
      // xiangmu 
      // console.log("");

    </script>
    <!-- If want light, use Eel, if want powerful, use cefpython-->

</body>
<!-- wei le xiang mu, zhe me zuo zhi de ma? yanjing ,shengti 
hen fan zao !!!!!!!
hen fu za de xing qing
bu zhi suo cuo, you bu yuan cheng reng 
hou hui
fan zao
tai duo dong xi yao zuo

ge ge bu rang yong 

ying xiang xue xi 
-->

</html>